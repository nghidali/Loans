---
title: "L02 More Models"
subtitle: "Data Science III (STAT 301-3)"
author: "NATALIE GHIDALI"
output: 
  html_document:
    toc: true
    toc_float: true
    highlight: "tango"
---

Load libraries
```{r}
library(tidyverse)
library(tidymodels)
```

## A nicely formatted table that lists the 8 general types of model and the best performance it achieved. 
```{r}
model_accuracies <- readRDS("model_info/output/model_accuracies.rds")
model_accuracies
```

##  A nicely formatted table that lists the run time for the tuning process for the 8 model types (could be combined with first table).

```{r}
model_times <- readRDS("model_info/output/model_times.rds")
model_times
```

## Final selection, training, and evaluation of the best model. 
```{r}
# The best performing model is the Support Vector Machine using a radial basis function with an accuracy of  0.8100224
load("model_info/input/svm_rbf_variables.rda")
load("model_info/input/wildfires_split.rda")
svm_rbf_tuned <- readRDS("model_info/output/svm_rbf_tuned.rds")

svm_rbf_finalized <- svm_rbf_workflow %>%
  finalize_workflow(select_best(svm_rbf_tuned, metric = "accuracy")) %>%
  fit(wildfires_train)

svm_rbf_predictions <- predict(svm_rbf_finalized, new_data = wildfires_test, type = "prob") %>%
  bind_cols(wildfires_test %>% select(wlf)) %>%
  mutate(.pred_class = fct_rev(as.factor(ifelse(.pred_yes > .pred_no, "yes", "no"))))

wildfires_metrics <- metric_set(accuracy)
svm_rbf_predictions %>%
  wildfires_metrics(truth = wlf, estimate = .pred_class)
```
The Support Vector Machine using a radial basis function has an accuracy of 0.7676768	on the test data set

```{r}
conf_mat(svm_rbf_predictions, truth = wlf, estimate = .pred_class)
# Prediction yes no
# yes  33 10
# no   13 43
```
The confusion matrix depicts that the model is fairly symmetric in its predictions. False positives and false negatives are about even.

```{r}
autoplot(roc_curve(svm_rbf_predictions,truth = wlf,estimate = .pred_yes))
```

The ROC curve illustrates that our model has fairly good sensitivity and specificity and is symmetrically predicting the outcome.

## Github Repo Link

[https://github.com/STAT301III/L02-more-models-nghidali](https://github.com/STAT301III/L02-more-models-nghidali){target="_blank"}

